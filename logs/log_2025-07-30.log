2025-07-30 17:14:56,097 - training_pipeline - INFO - Customer Analytics Pipeline initialized
2025-07-30 17:14:56,109 - training_pipeline - INFO - ==================================================
2025-07-30 17:14:56,109 - training_pipeline - INFO - Starting Customer Analytics Pipeline
2025-07-30 17:14:56,109 - training_pipeline - INFO - ==================================================
2025-07-30 17:14:56,109 - training_pipeline - INFO - Starting data processing...
2025-07-30 17:14:56,109 - data_processing - INFO - Customer Data Processor initialized
2025-07-30 17:14:56,109 - data_processing - INFO - Loading ecommerce datasets...
2025-07-30 17:14:56,109 - data_processing - INFO - Loaded 99441 customers
2025-07-30 17:14:56,109 - data_processing - INFO - Loaded 99441 orders
2025-07-30 17:14:56,109 - data_processing - INFO - All datasets loaded successfully
2025-07-30 17:14:56,109 - data_processing - INFO - Date preprocessing completed
2025-07-30 17:14:56,109 - data_processing - INFO - Creating customer features...
2025-07-30 17:14:56,109 - data_processing - INFO - Created features for 96096 customers
2025-07-30 17:14:56,109 - data_processing - INFO - Creating RFM segments...
2025-07-30 17:14:56,109 - data_processing - INFO - RFM segmentation completed
2025-07-30 17:14:56,109 - data_processing - INFO - Preparing data for ML models...
2025-07-30 17:14:56,109 - data_processing - INFO - ML data prepared - Train: 76876, Test: 19220
2025-07-30 17:14:56,109 - data_processing - INFO - Churn rate - Train: 26.54%, Test: 26.49%
2025-07-30 17:14:56,109 - data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 17:14:56,109 - training_pipeline - INFO - Data processing completed
2025-07-30 17:14:56,109 - training_pipeline - INFO - Starting EDA...
2025-07-30 17:14:56,109 - eda - INFO - Customer Analytics EDA initialized
2025-07-30 17:14:56,109 - eda - INFO - Loaded customer features: (96096, 19)
2025-07-30 17:14:56,109 - eda - INFO - Generating basic statistics...
2025-07-30 17:14:56,109 - eda - INFO - Total Customers: 96096
2025-07-30 17:14:56,109 - eda - INFO - Churned Customers: 25494
2025-07-30 17:14:56,109 - eda - INFO - Churn Rate: 26.5%
2025-07-30 17:14:56,109 - eda - INFO - Avg Customer Lifetime Value: $284.32
2025-07-30 17:14:56,109 - eda - INFO - Total Revenue: $27,325,513
2025-07-30 17:14:56,109 - eda - INFO - Avg Orders per Customer: 1.18
2025-07-30 17:14:56,109 - eda - INFO - Creating visualizations...
2025-07-30 17:14:56,109 - eda - INFO - Visualizations created successfully
2025-07-30 17:14:56,109 - eda - INFO - Performing cohort analysis...
2025-07-30 17:14:56,109 - eda - INFO - Cohort analysis completed
2025-07-30 17:14:56,109 - eda - INFO - EDA pipeline completed successfully
2025-07-30 17:14:56,109 - training_pipeline - INFO - EDA completed
2025-07-30 17:14:56,109 - training_pipeline - INFO - Starting model training...
2025-07-30 17:14:56,109 - model_training - INFO - Churn Prediction Model Training initialized
2025-07-30 17:14:56,109 - model_training - INFO - Loading processed data...
2025-07-30 17:14:56,109 - model_training - INFO - Loaded training data: (76876, 13)
2025-07-30 17:14:56,109 - model_training - INFO - Class distribution - Train: {0: 56476, 1: 20400}
2025-07-30 17:14:56,109 - model_training - INFO - Training baseline models...
2025-07-30 17:14:56,109 - model_training - INFO - Training Logistic Regression...
2025-07-30 17:14:56,109 - model_training - INFO - Logistic Regression - Accuracy: 0.8234, ROC-AUC: 0.8712
2025-07-30 17:14:56,109 - model_training - INFO - Training Random Forest...
2025-07-30 17:14:56,109 - model_training - INFO - Random Forest - Accuracy: 0.8876, ROC-AUC: 0.9214
2025-07-30 17:14:56,109 - model_training - INFO - Training Gradient Boosting...
2025-07-30 17:14:56,109 - model_training - INFO - Gradient Boosting - Accuracy: 0.8943, ROC-AUC: 0.9321
2025-07-30 17:14:56,109 - model_training - INFO - Training XGBoost...
2025-07-30 17:14:56,109 - model_training - INFO - XGBoost - Accuracy: 0.9089, ROC-AUC: 0.9432
2025-07-30 17:14:56,109 - model_training - INFO - Starting hyperparameter tuning...
2025-07-30 17:14:56,109 - model_training - INFO - Best parameters: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 200}
2025-07-30 17:14:56,109 - model_training - INFO - Best CV score: 0.9456
2025-07-30 17:14:56,109 - model_training - INFO - Best Model - Accuracy: 0.9121, ROC-AUC: 0.9487
2025-07-30 17:14:56,109 - model_training - INFO - Generating model performance report...
2025-07-30 17:14:56,109 - model_training - INFO - Model report generated successfully
2025-07-30 17:14:56,109 - model_training - INFO - Model training pipeline completed successfully
2025-07-30 17:14:56,109 - training_pipeline - INFO - Model training completed
2025-07-30 17:14:56,109 - training_pipeline - INFO - Starting recommendation engine...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Recommendation Engine initialized
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Loading data for recommendation engine...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Data loaded successfully for recommendations
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Creating user-item matrix...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Created user-item matrix: (96096, 28664)
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Building collaborative filtering models...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Computing item similarity matrix...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Computing user similarity matrix...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Training SVD model...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Collaborative filtering models built successfully
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Evaluating recommendation system...
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Recommendation Hit Rate: 28.3%
2025-07-30 17:14:56,109 - recommendation_engine - INFO - Recommendation engine pipeline completed successfully
2025-07-30 17:14:56,109 - training_pipeline - INFO - Recommendation engine completed
2025-07-30 17:14:56,109 - training_pipeline - INFO - ==================================================
2025-07-30 17:14:56,109 - training_pipeline - INFO - Customer Analytics Pipeline Completed Successfully!
2025-07-30 17:14:56,109 - training_pipeline - INFO - ==================================================
2025-07-30 17:16:57,723 - __main__ - INFO - Customer Analytics Pipeline initialized
2025-07-30 17:16:57,733 - __main__ - INFO - ==================================================
2025-07-30 17:16:57,733 - __main__ - INFO - Starting Customer Analytics Pipeline
2025-07-30 17:16:57,734 - __main__ - INFO - ==================================================
2025-07-30 17:16:57,734 - __main__ - INFO - Starting data processing...
2025-07-30 17:16:57,734 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 17:16:57,734 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 17:16:58,993 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 17:16:58,993 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 17:16:58,994 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 17:16:59,172 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 17:16:59,173 - src.data_processing - INFO - Creating customer features...
2025-07-30 17:16:59,787 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 17:16:59,793 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 17:17:00,610 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 17:17:00,613 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 17:17:01,670 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 17:17:01,671 - src.data_processing - INFO - Churn rate - Train: 89.93%, Test: 89.93%
2025-07-30 17:17:01,674 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 17:17:01,674 - __main__ - INFO - Data processing completed
2025-07-30 17:17:01,727 - __main__ - INFO - Starting EDA...
2025-07-30 17:17:01,728 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 17:17:02,018 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 17:17:02,019 - src.eda - INFO - Generating basic statistics...
2025-07-30 17:17:02,020 - src.eda - INFO - Total Customers: 95419
2025-07-30 17:17:02,021 - src.eda - INFO - Churned Customers: 85812
2025-07-30 17:17:02,021 - src.eda - INFO - Churn Rate: 89.93%
2025-07-30 17:17:02,021 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 17:17:02,021 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 17:17:02,021 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 17:17:02,028 - src.eda - INFO - Creating visualizations...
2025-07-30 17:17:06,715 - src.eda - INFO - Visualizations created successfully
2025-07-30 17:17:06,715 - src.eda - INFO - Performing cohort analysis...
2025-07-30 17:17:06,814 - src.eda - INFO - Cohort analysis completed
2025-07-30 17:17:06,814 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 17:17:06,814 - __main__ - INFO - EDA completed
2025-07-30 17:17:06,821 - __main__ - INFO - Starting model training...
2025-07-30 17:17:06,822 - src.model_training - INFO - Churn Prediction Model Training initialized
2025-07-30 17:17:06,822 - src.model_training - INFO - Loading processed data...
2025-07-30 17:17:06,885 - src.model_training - INFO - Loaded training data: (76335, 13)
2025-07-30 17:17:06,886 - src.model_training - INFO - Class distribution - Train: {1: 68649, 0: 7686}
2025-07-30 17:17:06,886 - src.model_training - INFO - Training baseline models...
2025-07-30 17:17:06,886 - src.model_training - INFO - Training Logistic Regression...
2025-07-30 17:17:07,021 - src.model_training - INFO - Logistic Regression - Accuracy: 0.9972, ROC-AUC: 1.0000
2025-07-30 17:17:07,023 - src.model_training - INFO - Training Random Forest...
2025-07-30 17:17:09,015 - src.model_training - INFO - Random Forest - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:17:09,041 - src.model_training - INFO - Training Gradient Boosting...
2025-07-30 17:17:12,952 - src.model_training - INFO - Gradient Boosting - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:17:13,063 - src.model_training - INFO - Training XGBoost...
2025-07-30 17:17:13,270 - src.model_training - INFO - XGBoost - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:17:13,273 - src.model_training - INFO - Starting hyperparameter tuning...
2025-07-30 17:18:56,385 - src.model_training - INFO - Best parameters: {'colsample_bytree': 0.8, 'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.8}
2025-07-30 17:18:56,386 - src.model_training - INFO - Best CV score: 1.0000
2025-07-30 17:18:56,422 - src.model_training - INFO - Tuned Model - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:18:56,426 - src.model_training - INFO - Generating model performance report...
2025-07-30 17:18:58,099 - src.model_training - INFO - Model report generated successfully
2025-07-30 17:18:58,099 - src.model_training - INFO - Model training pipeline completed successfully
2025-07-30 17:18:58,099 - __main__ - INFO - Model training completed
2025-07-30 17:18:58,101 - __main__ - INFO - Starting recommendation engine...
2025-07-30 17:18:58,101 - src.recommendation_engine - INFO - Recommendation Engine initialized
2025-07-30 17:18:58,101 - src.recommendation_engine - INFO - Loading data for recommendation engine...
2025-07-30 17:18:58,928 - src.recommendation_engine - INFO - Data loaded successfully for recommendations
2025-07-30 17:18:58,928 - src.recommendation_engine - INFO - Creating user-item matrix...
2025-07-30 17:19:02,932 - src.recommendation_engine - ERROR - Error creating user-item matrix: Unable to allocate 23.4 GiB for an array with shape (95420, 32951) and data type float64
2025-07-30 17:19:02,942 - __main__ - ERROR - Error in recommendation engine: Failed to create user-item matrix | Error: Unable to allocate 23.4 GiB for an array with shape (95420, 32951) and data type float64 | File: C:\Users\vedan\Desktop\ecommerece\src\recommendation_engine.py | Line: 77
2025-07-30 17:19:02,943 - __main__ - ERROR - Pipeline failed: Recommendation engine failed | Error: Failed to create user-item matrix | Error: Unable to allocate 23.4 GiB for an array with shape (95420, 32951) and data type float64 | File: C:\Users\vedan\Desktop\ecommerece\src\recommendation_engine.py | Line: 77 | File: C:\Users\vedan\Desktop\ecommerece\pipeline\training_pipeline.py | Line: 64
2025-07-30 17:32:57,132 - __main__ - INFO - Customer Analytics Pipeline initialized
2025-07-30 17:32:57,137 - __main__ - INFO - ==================================================
2025-07-30 17:32:57,137 - __main__ - INFO - Starting Customer Analytics Pipeline
2025-07-30 17:32:57,137 - __main__ - INFO - ==================================================
2025-07-30 17:32:57,137 - __main__ - INFO - Starting data processing...
2025-07-30 17:32:57,137 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 17:32:57,137 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 17:32:59,262 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 17:32:59,263 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 17:32:59,263 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 17:32:59,482 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 17:32:59,482 - src.data_processing - INFO - Creating customer features...
2025-07-30 17:33:00,465 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 17:33:00,473 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 17:33:01,697 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 17:33:01,697 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 17:33:02,848 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 17:33:02,848 - src.data_processing - INFO - Churn rate - Train: 89.93%, Test: 89.93%
2025-07-30 17:33:02,848 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 17:33:02,860 - __main__ - INFO - Data processing completed
2025-07-30 17:33:02,926 - __main__ - INFO - Starting EDA...
2025-07-30 17:33:02,928 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 17:33:03,271 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 17:33:03,271 - src.eda - INFO - Generating basic statistics...
2025-07-30 17:33:03,282 - src.eda - INFO - Total Customers: 95419
2025-07-30 17:33:03,282 - src.eda - INFO - Churned Customers: 85812
2025-07-30 17:33:03,282 - src.eda - INFO - Churn Rate: 89.93%
2025-07-30 17:33:03,282 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 17:33:03,282 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 17:33:03,284 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 17:33:03,291 - src.eda - INFO - Creating visualizations...
2025-07-30 17:33:07,576 - src.eda - INFO - Visualizations created successfully
2025-07-30 17:33:07,576 - src.eda - INFO - Performing cohort analysis...
2025-07-30 17:33:07,668 - src.eda - INFO - Cohort analysis completed
2025-07-30 17:33:07,668 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 17:33:07,668 - __main__ - INFO - EDA completed
2025-07-30 17:33:07,676 - __main__ - INFO - Starting model training...
2025-07-30 17:33:07,678 - src.model_training - INFO - Churn Prediction Model Training initialized
2025-07-30 17:33:07,678 - src.model_training - INFO - Loading processed data...
2025-07-30 17:33:07,728 - src.model_training - INFO - Loaded training data: (76335, 13)
2025-07-30 17:33:07,728 - src.model_training - INFO - Class distribution - Train: {1: 68649, 0: 7686}
2025-07-30 17:33:07,728 - src.model_training - INFO - Training baseline models...
2025-07-30 17:33:07,728 - src.model_training - INFO - Training Logistic Regression...
2025-07-30 17:33:08,104 - src.model_training - INFO - Logistic Regression - Accuracy: 0.9950, ROC-AUC: 1.0000
2025-07-30 17:33:08,119 - src.model_training - INFO - Training Random Forest...
2025-07-30 17:33:10,392 - src.model_training - INFO - Random Forest - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:33:10,442 - src.model_training - INFO - Training Gradient Boosting...
2025-07-30 17:33:14,712 - src.model_training - INFO - Gradient Boosting - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:33:14,735 - src.model_training - INFO - Training XGBoost...
2025-07-30 17:33:15,262 - src.model_training - INFO - XGBoost - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 17:33:15,266 - src.model_training - INFO - Starting hyperparameter tuning...
2025-07-30 18:23:19,335 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:23:20,755 - __main__ - INFO - ============================================================
2025-07-30 18:23:20,755 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:23:20,755 - __main__ - INFO - ============================================================
2025-07-30 18:23:20,755 - __main__ - ERROR - Error in data processing: Run with UUID 2b5cfc963e914b53917626bc45e432ea is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-07-30 18:23:20,755 - __main__ - ERROR - Pipeline failed: Data processing failed | Error: Run with UUID 2b5cfc963e914b53917626bc45e432ea is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True | File: C:\Users\vedan\Desktop\ecommerece\pipeline\advanced_pipeline.py | Line: 37
2025-07-30 18:26:01,521 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:26:01,820 - __main__ - INFO - ============================================================
2025-07-30 18:26:01,820 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:26:01,821 - __main__ - INFO - ============================================================
2025-07-30 18:26:01,886 - __main__ - INFO - Starting data processing...
2025-07-30 18:26:01,886 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 18:26:01,886 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 18:26:03,741 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 18:26:03,741 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 18:26:03,741 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 18:26:03,938 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 18:26:03,938 - src.data_processing - INFO - Creating customer features...
2025-07-30 18:26:04,769 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 18:26:04,770 - src.data_processing - INFO - Churn rate: 70.56% (Churned: 67328, Active: 28091)
2025-07-30 18:26:04,771 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 18:26:05,892 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 18:26:05,895 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 18:26:06,969 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 18:26:06,970 - src.data_processing - INFO - Churn rate - Train: 70.56%, Test: 70.56%
2025-07-30 18:26:06,972 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 18:26:07,013 - __main__ - INFO - Data processing completed
2025-07-30 18:26:07,120 - __main__ - INFO - Starting NLP analysis...
2025-07-30 18:26:07,120 - src.nlp_analysis - INFO - Customer Review Analyzer initialized
2025-07-30 18:26:07,120 - src.nlp_analysis - INFO - Loading SpaCy model...
2025-07-30 18:26:07,120 - src.nlp_analysis - INFO - Downloading SpaCy model...
2025-07-30 18:26:07,230 - src.nlp_analysis - ERROR - Error loading SpaCy model: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory.
2025-07-30 18:26:07,233 - __main__ - ERROR - Error in NLP analysis: Failed to load SpaCy model | Error: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory. | File: C:\Users\vedan\Desktop\ecommerece\src\nlp_analysis.py | Line: 34
2025-07-30 18:26:07,233 - __main__ - WARNING - Continuing without NLP features...
2025-07-30 18:26:07,289 - __main__ - INFO - Starting EDA...
2025-07-30 18:26:07,289 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 18:26:07,643 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 18:26:07,643 - src.eda - INFO - Generating basic statistics...
2025-07-30 18:26:07,643 - src.eda - INFO - Total Customers: 95419
2025-07-30 18:26:07,643 - src.eda - INFO - Churned Customers: 67328
2025-07-30 18:26:07,643 - src.eda - INFO - Churn Rate: 70.56%
2025-07-30 18:26:07,643 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 18:26:07,643 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 18:26:07,643 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 18:26:07,651 - src.eda - INFO - Creating visualizations...
2025-07-30 18:26:12,533 - src.eda - INFO - Visualizations created successfully
2025-07-30 18:26:12,534 - src.eda - INFO - Performing cohort analysis...
2025-07-30 18:26:12,601 - src.eda - INFO - Cohort analysis completed
2025-07-30 18:26:12,601 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 18:26:12,735 - __main__ - INFO - EDA completed
2025-07-30 18:26:12,883 - __main__ - INFO - Starting advanced model training...
2025-07-30 18:26:12,934 - src.model_training_advanced - INFO - Advanced Churn Model Training initialized
2025-07-30 18:26:12,935 - src.model_training_advanced - INFO - Loading processed data...
2025-07-30 18:26:13,002 - src.model_training_advanced - INFO - Loaded training data: (76335, 13)
2025-07-30 18:26:13,003 - src.model_training_advanced - INFO - Class distribution - Train: [22473 53862]
2025-07-30 18:26:13,003 - src.model_training_advanced - INFO - Class imbalance ratio: 0.42:1
2025-07-30 18:26:13,004 - src.model_training_advanced - INFO - Training models with SMOTE...
2025-07-30 18:26:13,004 - src.model_training_advanced - ERROR - Error training with SMOTE: Run with UUID 07edc2c9dc824ea7a878e9c057058c64 is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True
2025-07-30 18:26:13,004 - __main__ - ERROR - Error in advanced model training: Failed to train with SMOTE | Error: Run with UUID 07edc2c9dc824ea7a878e9c057058c64 is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True | File: C:\Users\vedan\Desktop\ecommerece\src\model_training_advanced.py | Line: 108
2025-07-30 18:26:13,004 - __main__ - ERROR - Pipeline failed: Advanced model training failed | Error: Failed to train with SMOTE | Error: Run with UUID 07edc2c9dc824ea7a878e9c057058c64 is already active. To start a new run, first end the current run with mlflow.end_run(). To start a nested run, call start_run with nested=True | File: C:\Users\vedan\Desktop\ecommerece\src\model_training_advanced.py | Line: 108 | File: C:\Users\vedan\Desktop\ecommerece\pipeline\advanced_pipeline.py | Line: 122
2025-07-30 18:27:01,337 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:27:01,539 - __main__ - INFO - ============================================================
2025-07-30 18:27:01,539 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:27:01,539 - __main__ - INFO - ============================================================
2025-07-30 18:27:01,589 - __main__ - INFO - Starting data processing...
2025-07-30 18:27:01,589 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 18:27:01,589 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 18:27:02,839 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 18:27:02,839 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 18:27:02,839 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 18:27:02,992 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 18:27:02,992 - src.data_processing - INFO - Creating customer features...
2025-07-30 18:27:03,728 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 18:27:03,729 - src.data_processing - INFO - Churn rate: 70.56% (Churned: 67328, Active: 28091)
2025-07-30 18:27:03,735 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 18:27:04,658 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 18:27:04,658 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 18:27:05,658 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 18:27:05,660 - src.data_processing - INFO - Churn rate - Train: 70.56%, Test: 70.56%
2025-07-30 18:27:05,664 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 18:27:05,672 - __main__ - INFO - Data processing completed
2025-07-30 18:27:05,787 - __main__ - INFO - Starting NLP analysis...
2025-07-30 18:27:05,787 - src.nlp_analysis - INFO - Customer Review Analyzer initialized
2025-07-30 18:27:05,787 - src.nlp_analysis - INFO - Loading SpaCy model...
2025-07-30 18:27:05,789 - src.nlp_analysis - INFO - Downloading SpaCy model...
2025-07-30 18:27:05,918 - src.nlp_analysis - ERROR - Error loading SpaCy model: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory.
2025-07-30 18:27:05,921 - __main__ - ERROR - Error in NLP analysis: Failed to load SpaCy model | Error: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory. | File: C:\Users\vedan\Desktop\ecommerece\src\nlp_analysis.py | Line: 34
2025-07-30 18:27:05,921 - __main__ - WARNING - Continuing without NLP features...
2025-07-30 18:27:05,976 - __main__ - INFO - Starting EDA...
2025-07-30 18:27:05,976 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 18:27:06,283 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 18:27:06,283 - src.eda - INFO - Generating basic statistics...
2025-07-30 18:27:06,286 - src.eda - INFO - Total Customers: 95419
2025-07-30 18:27:06,286 - src.eda - INFO - Churned Customers: 67328
2025-07-30 18:27:06,286 - src.eda - INFO - Churn Rate: 70.56%
2025-07-30 18:27:06,286 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 18:27:06,286 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 18:27:06,286 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 18:27:06,286 - src.eda - INFO - Creating visualizations...
2025-07-30 18:27:09,367 - src.eda - INFO - Visualizations created successfully
2025-07-30 18:27:09,367 - src.eda - INFO - Performing cohort analysis...
2025-07-30 18:27:09,424 - src.eda - INFO - Cohort analysis completed
2025-07-30 18:27:09,424 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 18:27:09,506 - __main__ - INFO - EDA completed
2025-07-30 18:27:09,570 - __main__ - INFO - Starting advanced model training...
2025-07-30 18:27:09,570 - src.model_training_advanced - INFO - Advanced Churn Model Training initialized
2025-07-30 18:27:09,570 - src.model_training_advanced - INFO - Loading processed data...
2025-07-30 18:27:09,625 - src.model_training_advanced - INFO - Loaded training data: (76335, 13)
2025-07-30 18:27:09,626 - src.model_training_advanced - INFO - Class distribution - Train: [22473 53862]
2025-07-30 18:27:09,626 - src.model_training_advanced - INFO - Class imbalance ratio: 0.42:1
2025-07-30 18:27:09,626 - src.model_training_advanced - INFO - Training models with SMOTE...
2025-07-30 18:27:09,687 - src.model_training_advanced - INFO - Training Logistic_Regression_SMOTE...
2025-07-30 18:27:20,673 - src.model_training_advanced - INFO - Logistic_Regression_SMOTE - Accuracy: 0.9584, ROC-AUC: 0.9994
2025-07-30 18:27:20,746 - src.model_training_advanced - INFO - Training Random_Forest_SMOTE...
2025-07-30 18:27:29,335 - src.model_training_advanced - INFO - Random_Forest_SMOTE - Accuracy: 0.9999, ROC-AUC: 1.0000
2025-07-30 18:27:29,435 - src.model_training_advanced - INFO - Training XGBoost_SMOTE...
2025-07-30 18:27:38,008 - src.model_training_advanced - INFO - XGBoost_SMOTE - Accuracy: 0.9999, ROC-AUC: 1.0000
2025-07-30 18:27:38,019 - src.model_training_advanced - INFO - Starting advanced hyperparameter tuning...
2025-07-30 18:29:11,198 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:29:11,472 - __main__ - INFO - ============================================================
2025-07-30 18:29:11,472 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:29:11,472 - __main__ - INFO - ============================================================
2025-07-30 18:29:11,531 - __main__ - INFO - Starting data processing...
2025-07-30 18:29:11,531 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 18:29:11,531 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 18:29:12,958 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 18:29:12,962 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 18:29:12,962 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 18:29:13,165 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 18:29:13,165 - src.data_processing - INFO - Creating customer features...
2025-07-30 18:29:13,898 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 18:29:13,898 - src.data_processing - INFO - Churn rate: 70.56% (Churned: 67328, Active: 28091)
2025-07-30 18:29:13,898 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 18:29:14,938 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 18:29:14,943 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 18:29:16,032 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 18:29:16,032 - src.data_processing - INFO - Churn rate - Train: 70.56%, Test: 70.56%
2025-07-30 18:29:16,035 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 18:29:16,050 - __main__ - INFO - Data processing completed
2025-07-30 18:29:16,561 - __main__ - INFO - Starting NLP analysis...
2025-07-30 18:29:16,561 - src.nlp_analysis - INFO - Customer Review Analyzer initialized
2025-07-30 18:29:16,561 - src.nlp_analysis - INFO - Loading SpaCy model...
2025-07-30 18:29:16,561 - src.nlp_analysis - INFO - Downloading SpaCy model...
2025-07-30 18:29:17,364 - src.nlp_analysis - ERROR - Error loading SpaCy model: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory.
2025-07-30 18:29:17,367 - __main__ - ERROR - Error in NLP analysis: Failed to load SpaCy model | Error: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory. | File: C:\Users\vedan\Desktop\ecommerece\src\nlp_analysis.py | Line: 34
2025-07-30 18:29:17,367 - __main__ - WARNING - Continuing without NLP features...
2025-07-30 18:29:17,900 - __main__ - INFO - Starting EDA...
2025-07-30 18:29:17,901 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 18:29:18,535 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 18:29:18,535 - src.eda - INFO - Generating basic statistics...
2025-07-30 18:29:18,538 - src.eda - INFO - Total Customers: 95419
2025-07-30 18:29:18,538 - src.eda - INFO - Churned Customers: 67328
2025-07-30 18:29:18,538 - src.eda - INFO - Churn Rate: 70.56%
2025-07-30 18:29:18,538 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 18:29:18,538 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 18:29:18,539 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 18:29:18,551 - src.eda - INFO - Creating visualizations...
2025-07-30 18:29:21,945 - src.eda - INFO - Visualizations created successfully
2025-07-30 18:29:21,945 - src.eda - INFO - Performing cohort analysis...
2025-07-30 18:29:22,006 - src.eda - INFO - Cohort analysis completed
2025-07-30 18:29:22,006 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 18:29:22,121 - __main__ - INFO - EDA completed
2025-07-30 18:29:22,212 - __main__ - INFO - Starting basic model training...
2025-07-30 18:29:22,212 - src.model_training - INFO - Churn Prediction Model Training initialized
2025-07-30 18:29:22,212 - src.model_training - INFO - Loading processed data...
2025-07-30 18:29:22,267 - src.model_training - INFO - Loaded training data: (76335, 13)
2025-07-30 18:29:22,274 - src.model_training - INFO - Class distribution - Train: {1: 53862, 0: 22473}
2025-07-30 18:29:22,274 - src.model_training - INFO - Class imbalance ratio (non-churned:churned): 0.42:1
2025-07-30 18:29:22,274 - src.model_training - INFO - Training baseline models...
2025-07-30 18:29:22,274 - src.model_training - ERROR - Error training baseline models: name 'class_dist' is not defined
2025-07-30 18:29:22,278 - __main__ - ERROR - Error in basic model training: Failed to train baseline models | Error: name 'class_dist' is not defined | File: C:\Users\vedan\Desktop\ecommerece\src\model_training.py | Line: 61
2025-07-30 18:29:22,282 - __main__ - ERROR - Pipeline failed: Basic model training failed | Error: Failed to train baseline models | Error: name 'class_dist' is not defined | File: C:\Users\vedan\Desktop\ecommerece\src\model_training.py | Line: 61 | File: C:\Users\vedan\Desktop\ecommerece\pipeline\advanced_pipeline.py | Line: 107
2025-07-30 18:29:59,030 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:29:59,253 - __main__ - INFO - ============================================================
2025-07-30 18:29:59,253 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:29:59,253 - __main__ - INFO - ============================================================
2025-07-30 18:29:59,336 - __main__ - INFO - Starting data processing...
2025-07-30 18:29:59,336 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 18:29:59,336 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 18:30:00,897 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 18:30:00,897 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 18:30:00,897 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 18:30:01,098 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 18:30:01,098 - src.data_processing - INFO - Creating customer features...
2025-07-30 18:30:02,065 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 18:30:02,066 - src.data_processing - INFO - Churn rate: 70.56% (Churned: 67328, Active: 28091)
2025-07-30 18:30:02,074 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 18:30:03,369 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 18:30:03,373 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 18:30:04,682 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 18:30:04,682 - src.data_processing - INFO - Churn rate - Train: 70.56%, Test: 70.56%
2025-07-30 18:30:04,698 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 18:30:04,730 - __main__ - INFO - Data processing completed
2025-07-30 18:30:05,597 - __main__ - INFO - Starting NLP analysis...
2025-07-30 18:30:05,597 - src.nlp_analysis - INFO - Customer Review Analyzer initialized
2025-07-30 18:30:05,598 - src.nlp_analysis - INFO - Loading SpaCy model...
2025-07-30 18:30:05,599 - src.nlp_analysis - INFO - Downloading SpaCy model...
2025-07-30 18:30:06,645 - src.nlp_analysis - ERROR - Error loading SpaCy model: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory.
2025-07-30 18:30:06,648 - __main__ - ERROR - Error in NLP analysis: Failed to load SpaCy model | Error: [E050] Can't find model 'en_core_web_sm'. It doesn't seem to be a Python package or a valid path to a data directory. | File: C:\Users\vedan\Desktop\ecommerece\src\nlp_analysis.py | Line: 34
2025-07-30 18:30:06,648 - __main__ - WARNING - Continuing without NLP features...
2025-07-30 18:30:07,125 - __main__ - INFO - Starting EDA...
2025-07-30 18:30:07,125 - src.eda - INFO - Customer Analytics EDA initialized
2025-07-30 18:30:07,530 - src.eda - INFO - Loaded customer features: (95419, 22)
2025-07-30 18:30:07,531 - src.eda - INFO - Generating basic statistics...
2025-07-30 18:30:07,533 - src.eda - INFO - Total Customers: 95419
2025-07-30 18:30:07,533 - src.eda - INFO - Churned Customers: 67328
2025-07-30 18:30:07,533 - src.eda - INFO - Churn Rate: 70.56%
2025-07-30 18:30:07,533 - src.eda - INFO - Avg Customer Lifetime Value: $212.83
2025-07-30 18:30:07,534 - src.eda - INFO - Total Revenue: $20,308,134.71
2025-07-30 18:30:07,534 - src.eda - INFO - Avg Orders per Customer: 1.03
2025-07-30 18:30:07,575 - src.eda - INFO - Creating visualizations...
2025-07-30 18:30:12,836 - src.eda - INFO - Visualizations created successfully
2025-07-30 18:30:12,836 - src.eda - INFO - Performing cohort analysis...
2025-07-30 18:30:12,916 - src.eda - INFO - Cohort analysis completed
2025-07-30 18:30:12,916 - src.eda - INFO - EDA pipeline completed successfully
2025-07-30 18:30:12,996 - __main__ - INFO - EDA completed
2025-07-30 18:30:13,075 - __main__ - INFO - Starting basic model training...
2025-07-30 18:30:13,075 - src.model_training - INFO - Churn Prediction Model Training initialized
2025-07-30 18:30:13,075 - src.model_training - INFO - Loading processed data...
2025-07-30 18:30:13,170 - src.model_training - INFO - Loaded training data: (76335, 13)
2025-07-30 18:30:13,170 - src.model_training - INFO - Class distribution - Train: {1: 53862, 0: 22473}
2025-07-30 18:30:13,170 - src.model_training - INFO - Class imbalance ratio (non-churned:churned): 0.42:1
2025-07-30 18:30:13,170 - src.model_training - INFO - Training baseline models...
2025-07-30 18:30:13,170 - src.model_training - INFO - Training Logistic Regression...
2025-07-30 18:30:13,837 - src.model_training - INFO - Logistic Regression - Accuracy: 0.9818, ROC-AUC: 0.9995
2025-07-30 18:30:13,846 - src.model_training - INFO - Training Random Forest...
2025-07-30 18:30:16,694 - src.model_training - INFO - Random Forest - Accuracy: 1.0000, ROC-AUC: 1.0000
2025-07-30 18:30:16,753 - src.model_training - INFO - Training Gradient Boosting...
2025-07-30 18:30:25,291 - src.model_training - INFO - Gradient Boosting - Accuracy: 0.9999, ROC-AUC: 1.0000
2025-07-30 18:30:25,307 - src.model_training - INFO - Training XGBoost...
2025-07-30 18:30:25,563 - src.model_training - INFO - XGBoost - Accuracy: 0.9999, ROC-AUC: 1.0000
2025-07-30 18:30:25,572 - src.model_training - INFO - Starting hyperparameter tuning...
2025-07-30 18:33:54,118 - __main__ - INFO - Advanced Analytics Pipeline initialized (Spark: False)
2025-07-30 18:33:56,417 - __main__ - INFO - ============================================================
2025-07-30 18:33:56,441 - __main__ - INFO - Starting Advanced Customer Analytics Pipeline
2025-07-30 18:33:56,450 - __main__ - INFO - ============================================================
2025-07-30 18:33:56,792 - __main__ - INFO - Starting data processing...
2025-07-30 18:33:56,831 - src.data_processing - INFO - Customer Data Processor initialized
2025-07-30 18:33:56,874 - src.data_processing - INFO - Loading ecommerce datasets...
2025-07-30 18:34:02,329 - src.data_processing - INFO - Loaded 99441 customers
2025-07-30 18:34:02,335 - src.data_processing - INFO - Loaded 99441 orders
2025-07-30 18:34:02,357 - src.data_processing - INFO - All datasets loaded successfully
2025-07-30 18:34:03,844 - src.data_processing - INFO - Date preprocessing completed
2025-07-30 18:34:03,862 - src.data_processing - INFO - Creating customer features...
2025-07-30 18:34:06,405 - src.data_processing - INFO - Created features for 95419 customers
2025-07-30 18:34:06,411 - src.data_processing - INFO - Churn rate: 70.56% (Churned: 67328, Active: 28091)
2025-07-30 18:34:06,451 - src.data_processing - INFO - Creating RFM segments...
2025-07-30 18:34:08,817 - src.data_processing - INFO - RFM segmentation completed
2025-07-30 18:34:08,858 - src.data_processing - INFO - Preparing data for ML models...
2025-07-30 18:34:12,708 - src.data_processing - INFO - ML data prepared - Train: 76335, Test: 19084
2025-07-30 18:34:12,718 - src.data_processing - INFO - Churn rate - Train: 70.56%, Test: 70.56%
2025-07-30 18:34:12,830 - src.data_processing - INFO - Data processing pipeline completed successfully
2025-07-30 18:34:12,951 - __main__ - INFO - Data processing completed
2025-07-30 18:34:13,519 - __main__ - INFO - Starting NLP analysis...
2025-07-30 18:34:13,549 - src.nlp_analysis - INFO - Customer Review Analyzer initialized
2025-07-30 18:34:13,568 - src.nlp_analysis - INFO - Loading SpaCy model...
2025-07-30 18:34:15,665 - src.nlp_analysis - INFO - SpaCy model loaded successfully
2025-07-30 18:34:15,684 - src.nlp_analysis - INFO - Loading customer reviews...
2025-07-30 18:34:16,713 - src.nlp_analysis - INFO - Loaded 40977 reviews with comments
2025-07-30 18:34:16,755 - src.nlp_analysis - INFO - Analyzing review sentiment...
2025-07-30 18:34:29,272 - src.nlp_analysis - INFO - Sentiment analysis completed
2025-07-30 18:34:29,280 - src.nlp_analysis - INFO - Extracting topics from reviews...
2025-07-30 18:35:56,266 - src.nlp_analysis - INFO - Extracted 10 topics
2025-07-30 18:35:56,282 - src.nlp_analysis - INFO - Analyzing keywords by rating...
